init_config:

# To notify on every service, set a list of notified uses here.
#
#    notify:
#        - patrick@avatarnewyork.com
#        - pagerduty


instances:
<% $servertags = scope.function_split([description, ","]) -%>
<% $servertags.each do |servertag| -%>
<% if servertag == "ftp" -%>
    -   name: ftp21
        host: <%= scope.lookupvar('ipaddress_eth1') %>
        port: 21
        timeout: 2

         # The (optional) window and threshold parameters allow you to trigger
         # alerts only if the check fails x times within the last y attempts
         # where x is the threshold and y is the window.

        threshold: 3
        window: 5

        notify:
           - patrick@avatarnewyork.com

<% end -%>
<% if servertag == "sphinx" -%>
    -   name: sphinx9312
        host: <%= scope.lookupvar('ipaddress_eth1') %>
        port: 9312
        timeout: 2

         # The (optional) window and threshold parameters allow you to trigger
         # alerts only if the check fails x times within the last y attempts
         # where x is the threshold and y is the window.

        threshold: 3
        window: 5

        notify:
           - patrick@avatarnewyork.com

    -   name: sphinx9306
        host: <%= scope.lookupvar('ipaddress_eth1') %>
        port: 9306
        timeout: 2

         # The (optional) window and threshold parameters allow you to trigger
         # alerts only if the check fails x times within the last y attempts
         # where x is the threshold and y is the window.

        threshold: 3
        window: 5

        notify:
           - patrick@avatarnewyork.com

<% end -%>
<% end -%>
